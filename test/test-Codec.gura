#!/usr/bin/env gurax
import(util.tester) {*}
import(hash)

TestCase('Property') {
	Codec.PrintPropSlots()
}

TestCase('') {
	buffSrc = Stream('test-Codec/chars-cp932.txt', 'r', 'cp932').ReadText().ToBinary()
	codecNames = ['sjis', 'utf8', 'utf16le', 'utf16be', 'utf32le', 'utf32be']
	codecNames.Each {|codecName|
		buff = Binary()
		buff.Writer(codecName).PipeFrom(buffSrc.Reader()):cooked
		buffRev = buff.Reader(codecName).ReadText().ToBinary()
		Printf('%-20s %s %s\n', codecName, hash.MD5().PipeFrom(buff).digestHex,
									cond(buffSrc == buffRev, 'OK', '*NG*'))
	}
}
