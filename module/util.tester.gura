#!/usr/bin/env gurax
//==============================================================================
// util.tester.gura
//==============================================================================
TestCase(title:String):void:dynamicScope {`block?} = scope {
	Printf('======== %s ========\n', title)
	block && block.Eval()
}

Tester(expr:Expr, arg%%):void:dynamicScope:map:[quote] {block?} = {
	Printf('%s ..', expr)
	try {
		rtn = expr.Eval()
		rtnStr = cond(arg.IsSet(`quote),
					rtn.ToString():quote:nilVisible
					rtn.ToString():quoteSymbol:nilVisible)
		Printf(cond(rtnStr.Find('\n'), '\n%s\n', ' %s\n'), rtnStr):noMap
		block && block(rtn)
	} catch {|e|
		Printf(' %s\n', e.text)
	}
}
